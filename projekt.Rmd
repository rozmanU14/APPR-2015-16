---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Urška Rožman"
output:
  pdf_document:
    latex_engine: xelatex
    includes:
      in_header: lib/styles.sty
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

Izbrala sem si temo z naslovom Analiza naravnega prirastka v Sloveniji in primerjava naravnega prirastka z drugimi Evropskimi državami. Analizirala bom rodnost, umrljivost in naravni prirastek v Sloveniji po regijah in spolu. V nadaljevanju pa ga bom primerjala s prirastkom v drugih Evropskih državah.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```
Podatke za prvo tabelo sem dobila na spletni strani statističnega urada Slovenije ter jih uvozila v CSV obliki, podatke za drugo tabelo pa sem v HTML obliki uvozila iz spletne strani EUROSTAT.

Povezave na podatke:
- http://ec.europa.eu/eurostat/web/population-demography-migration-projections/births-fertitily-data/database
- http://pxweb.stat.si/pxweb/Dialog/varval.asp?ma=05I1002S&ti=&path=../Database/Dem_soc/05_prebivalstvo/25_selitveno_gibanje/05_05I10_naravno_gibanje/&lang=2

Prva tabela vsebuje stolpce:
-  ime regije (imenska spremenljivka)
- leto (številska spremenljivka)
- število živorojenih moških (številska spremenljivka)
- število živorojenih ženske (številska spremenljivka)
- število umrlih moških (številska spremenljivka)
- število umrlih žensk (številska spremenljivka)
- naravni prirastek moških (številska spremenljivka)
- naravni prirastek žensk (številska spremenljivka)
Te stolpce sem prečistila (mesta kjer ni bilo podatka sem zamenjala z NA), izbrisala nepotrebne stolpce in vrstice ter zagotovila, da bodo številske spremenljivke res številske. Tabelo sem ločila na pet pod tabel, ki so bile ločene glede na leto. Dodala sem stolpec "skupni.prirast" ki je seštevek naravnega prirasta moških in žensk. Da bi bilo filtriranje podatkov še lažje, sem dodala še stolpec "velikost" ki je urejenostna spremenljivka in sicer klasificira prirastek kot "pozitiven","negativen" oziroma "ni prirastka".

Druga tabela, ki je bila uvožena v HTML obliki vsebuje podatke o naravnem prirastku evropskih držav. Najprej sem uvozila zgolj podatke o prirastku ki so klicani z eno spremenljivko,ter jih dala v matriko, kasneje pa še podatke o letih merjenja ter državah. Ko sem prečistila nepotrebne podatke (zamenjava znakov "-","("b") z NA, ter pri vektorju držav in let napotrebne znake med željenimi državami) sem podatke, države in leta združila v eno tabelo. Ker želim analizirati le podatke od 2010-2013 sem ostale stolpce izbrisala. 

```{r razpredelnice}
kable(head(druzine))
head(obcine)
```

Slika \ref{fig:histogram} prikazuje porazdelitev števila naselij v občinah.

```{r histogram, echo=FALSE, fig.align='center', fig.cap='Histogram števila naselij v občinah'}
hist(obcine[,4], main = "Pogostost števila naselij",
     xlab = "Število naselij", ylab = "Število občin")
```

***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE}
source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
```

Slika \ref{fig:zemljevid} prikazuje povprečno velikost družine za vsako občino.

```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'}
n <- 100
barve <- topo.colors(n)[1+(n-1)*(druzine$povprecje-min.povprecje)/(max.povprecje-min.povprecje)]
plot(zemljevid, col = barve)
title("Povprečno število otrok v družini")
```

***

# Napredna analiza podatkov

```{r analiza, echo=FALSE}
source("analiza/analiza.r", encoding = "UTF-8")
```

Slika \ref{fig:graf} prikazuje povezavo med številom naselij in površino občine.

```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'}
plot(obcine[[1]], obcine[[4]],
     main = "Število naselij glede na površino občine",
     xlab = expression("Površina (km"^2 * ")"),
     ylab = "Št. naselij",
     col = barve[obcine[[7]]],
     pch = 18)
legend("topright", legend = names(barve), col = barve,
       pch = 18, cex = 0.5, bg = "white")
```

***
